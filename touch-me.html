<!DOCTYPE html>
<html>
  <head>
    <title>Game Kotak</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }

      html {
        height: 100%;
        overflow: hidden;
      }

      body {
        background-color: #1B3C53;
        color: white;
        font-family: Arial, sans-serif;
        height: 100%;
        overflow: auto;
        -webkit-overflow-scrolling: touch;
        position: fixed;
        width: 100%;
        overflow-x: hidden;
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        -moz-text-size-adjust: 100%;
        text-size-adjust: 100%;
      }
      
      .game-section {
        padding: 80px 20px 40px;
        text-align: center;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      
      .game-area {
          width: 95%;
          max-width: 320px;
          height: 320px;
          margin: 20px auto;
          background: #234C6A;
          border: 2px solid #00eaff;
          border-radius: 15px;
          position: relative;
          overflow: hidden;
          touch-action: none;
      }
      
      .box {
          width: 50px;
          height: 50px;
          background: #00eaff;
          border-radius: 10px;
          position: absolute;
          cursor: pointer;
          transition: transform 0.1s;
          user-select: none;
          -webkit-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          touch-action: manipulation;
      }

      .box:active {
          transform: scale(0.9);
      }
      
      .score-board {
          margin-top: 15px;
          font-size: 22px;
          font-weight: bold;
          text-align: center;
          width: 100%;
      }

      .timer {
          margin-top: 10px;
          font-size: 20px;
          color: #ffea00;
          font-weight: bold;
          text-align: center;
          width: 100%;
      }

      #backBtn {
        position: fixed;
        top: 15px;
        left: 15px;
        background: #00eaff;
        padding: 10px 18px;
        color: #000;
        text-decoration: none;
        font-weight: bold;
        border-radius: 10px;
        font-size: 16px;
        box-shadow: 0 0 10px #00eaff66;
        transition: 0.2s;
        z-index: 100;
        border: none;
        cursor: pointer;
        user-select: none;
        -webkit-user-select: none;
      }
      
      #backBtn:active {
        transform: scale(0.95);
        background: #00f5ff;
      }

      h2 {
        font-size: 24px;
        margin-bottom: 10px;
        text-align: center;
      }

      p {
        font-size: 16px;
        margin-bottom: 20px;
        text-align: center;
        padding: 0 10px;
      }

      /* Responsif untuk mobile */
      @media (max-width: 480px) {
        .game-section {
          padding: 70px 15px 30px;
        }
        
        .game-area {
          width: 95%;
          max-width: 300px;
          height: 300px;
        }
        
        h2 {
          font-size: 22px;
        }
        
        p {
          font-size: 14px;
        }
        
        #backBtn {
          padding: 8px 15px;
          font-size: 14px;
          top: 10px;
          left: 10px;
        }
      }

      @media (max-width: 360px) {
        .game-area {
          height: 280px;
          max-width: 280px;
        }
        
        .box {
          width: 45px;
          height: 45px;
        }
      }

      /* Prevenir zoom en Android Chrome */
      html {
        -webkit-text-size-adjust: none;
        text-size-adjust: none;
      }

      /* Prevent pull-to-refresh on mobile */
      body {
        overscroll-behavior-y: contain;
      }

      /* Prevent highlighting on tap */
      .box, #backBtn {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
    </style>
  </head>
  <body>

    <a href="index.html" id="backBtn">‚üµ Kembali</a>

    <section id="game" class="game-section">
        <h2>Mini Game - 1 Menit</h2>
        <p>Klik kotak sebanyak mungkin sebelum 60 detik habis!</p>

        <div class="timer">
            Waktu: <span id="time">60</span>s
        </div>

        <div class="game-area" id="gameArea">
            <div class="box" id="box"></div>
        </div>

        <div class="score-board">
            Score: <span id="score">0</span>
        </div>
    </section>

    <script>
    // Cegah zoom double tap
    document.addEventListener('DOMContentLoaded', function() {
        let lastTouchEnd = 0;
        
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
        
        // Cegah zoom gesture
        document.addEventListener('gesturestart', function(event) {
            event.preventDefault();
        });
        
        // Cegah context menu pada box
        const box = document.getElementById('box');
        box.addEventListener('contextmenu', function(event) {
            event.preventDefault();
            return false;
        });
    });

    const box = document.getElementById("box");
    const gameArea = document.getElementById("gameArea");
    const scoreDisplay = document.getElementById("score");
    const timeDisplay = document.getElementById("time");

    let score = 0;
    let timeLeft = 60;
    let gameOver = false;

    let moveSpeed = 1000; // kecepatan awal (1 detik)
    let autoMove;

    // Pindahkan box ke posisi acak
    function moveBox() {
        if (gameOver) return;

        const areaWidth = gameArea.clientWidth - 50;
        const areaHeight = gameArea.clientHeight - 50;

        const randomX = Math.floor(Math.random() * areaWidth);
        const randomY = Math.floor(Math.random() * areaHeight);

        box.style.left = `${randomX}px`;
        box.style.top = `${randomY}px`;
    }

    // Restart interval autoMove setiap kali kecepatan berubah
    function updateSpeed() {
        clearInterval(autoMove);
        autoMove = setInterval(moveBox, moveSpeed);
    }

    // Event listener untuk klik box
    box.addEventListener("click", handleBoxClick);
    
    // Event listener untuk touch (mobile)
    box.addEventListener("touchstart", function(e) {
        e.preventDefault(); // Cegah event default
        handleBoxClick();
        
        // Feedback visual untuk touch
        this.style.transform = "scale(0.9)";
        setTimeout(() => {
            this.style.transform = "scale(1)";
        }, 100);
    }, { passive: false });

    function handleBoxClick() {
        if (gameOver) return;

        score++;
        scoreDisplay.textContent = score;

        // percepat: makin tinggi skor makin cepat
        moveSpeed = Math.max(150, 1000 - score * 30);  
        updateSpeed();

        moveBox();
    }

    // Timer 60 detik
    const timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            clearInterval(autoMove);
            gameOver = true;

            box.style.display = "none";

            // Gunakan modal alert yang lebih mobile-friendly
            setTimeout(function() {
                alert("Waktu Habis!\nScore kamu: " + score);
            }, 100);
            return;
        }

        timeLeft--;
        timeDisplay.textContent = timeLeft;
    }, 1000);

    // Mulai gerakan otomatis awal
    autoMove = setInterval(moveBox, moveSpeed);

    // Posisi awal
    moveBox();

    // Optimasi untuk resize
    window.addEventListener('resize', function() {
        if (!gameOver) {
            moveBox();
        }
    });

    // Cegah scroll saat menyentuh game area
    gameArea.addEventListener('touchmove', function(e) {
        if (e.target === box || e.target === gameArea) {
            e.preventDefault();
        }
    }, { passive: false });
    
    // Handle orientation change
    window.addEventListener('orientationchange', function() {
        setTimeout(moveBox, 300);
    });
    </script>
  </body>
</html>